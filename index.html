<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ù…Ù‡Ø§Ù… Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª - Ù…Ø±ÙƒØ² Ø§Ù„Ø·Ø§Ù‡Ø±Ø© Ù„Ù„Ø£Ø´Ø¹Ø©</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            background: #f5f6fa;
            color: #222;
            line-height: 1.6;
        }

        header {
            background: #0f62fe;
            color: #fff;
            padding: 20px 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        header h1 {
            font-size: 1.5rem;
            margin-bottom: 6px;
        }

        header h2 {
            font-size: 1rem;
            font-weight: 400;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .date-badge {
            margin-top: 10px;
            display: inline-block;
            background: rgba(255,255,255,0.14);
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 0.9rem;
        }

        main {
            max-width: 1150px;
            margin: 20px auto 40px auto;
            padding: 0 15px 40px 15px;
        }

        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .toolbar-left, .toolbar-right {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .btn {
            border: none;
            padding: 8px 14px;
            border-radius: 999px;
            cursor: pointer;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
        }

        .btn-primary {
            background: #0f62fe;
            color: #fff;
            box-shadow: 0 2px 6px rgba(15,98,254,0.35);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(15,98,254,0.4);
        }

        .btn-outline {
            background: #fff;
            color: #333;
            border: 1px solid #ddd;
        }

        .btn-outline:hover {
            background: #f3f6ff;
        }

        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #fff;
            border-radius: 999px;
            padding: 6px 12px;
            font-size: 0.85rem;
            border: 1px solid #e1e4f0;
        }

        .status-dot {
            width: 9px;
            height: 9px;
            border-radius: 50%;
            background: #34c759;
        }

        .category {
            margin-top: 18px;
            margin-bottom: 12px;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 8px;
        }

        .category h2 {
            font-size: 1.1rem;
            margin-bottom: 4px;
            color: #111827;
        }

        .category span {
            font-size: 0.85rem;
            color: #6b7280;
        }

        .task-list {
            background: #ffffff;
            border-radius: 16px;
            padding: 12px 12px 4px 12px;
            box-shadow: 0 10px 30px rgba(15,23,42,0.08);
            border: 1px solid #e5e7eb;
        }

        .task-item {
            display: grid;
            grid-template-columns: auto 1.7fr 0.9fr 1.1fr;
            gap: 10px;
            align-items: center;
            padding: 8px 6px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-checkbox {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .task-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .task-title {
            font-weight: 500;
        }

        .task-meta {
            font-size: 0.82rem;
            color: #4b5563;
        }

        .task-notes {
            font-size: 0.82rem;
            color: #6b7280;
        }

        .task-done .task-title {
            text-decoration: line-through;
            color: #6b7280;
        }

        .task-done {
            background: #f0fdf4;
        }

        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 0.74rem;
            margin-left: 4px;
            background: #eef2ff;
            color: #4f46e5;
        }

        .footer {
            text-align: center;
            margin-top: 22px;
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .footer strong {
            color: #4b5563;
        }

        /* Admin Panel */

        .admin-toggle-active {
            background: #111827;
            color: #fff;
        }

        .admin-panel {
            margin-top: 20px;
            margin-bottom: 25px;
            padding: 12px 14px 16px 14px;
            border-radius: 16px;
            background: #111827;
            color: #f9fafb;
            box-shadow: 0 12px 30px rgba(15,23,42,0.6);
        }

        .admin-panel h3 {
            margin-bottom: 6px;
            font-size: 1rem;
        }

        .admin-panel p {
            font-size: 0.8rem;
            color: #d1d5db;
            margin-bottom: 10px;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 10px;
            margin-bottom: 10px;
        }

        .admin-field {
            display: flex;
            flex-direction: column;
            gap: 3px;
            font-size: 0.8rem;
        }

        .admin-field label {
            color: #e5e7eb;
        }

        .admin-field input,
        .admin-field select,
        .admin-field textarea {
            border-radius: 10px;
            border: 1px solid #4b5563;
            padding: 6px 8px;
            font-size: 0.8rem;
            background: #020617;
            color: #f9fafb;
        }

        .admin-field textarea {
            resize: vertical;
            min-height: 60px;
        }

        .admin-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 6px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .admin-badge {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .admin-msg {
            margin-top: 6px;
            font-size: 0.78rem;
            min-height: 16px;
        }

        .admin-msg.success {
            color: #4ade80;
        }

        .admin-msg.error {
            color: #f97373;
        }

        .hidden {
            display: none;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border-radius: 999px;
            padding: 4px 10px;
            font-size: 0.75rem;
            background: #020617;
            color: #e5e7eb;
            border: 1px solid #4b5563;
        }

        @media (max-width: 900px) {
            .admin-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .task-item {
                grid-template-columns: auto 1.7fr;
                grid-template-rows: auto auto auto;
            }

            .task-meta {
                grid-column: 2 / 3;
            }

            .task-notes {
                grid-column: 2 / 3;
            }

            header h1 {
                font-size: 1.25rem;
            }

            header h2 {
                font-size: 0.9rem;
            }

            .admin-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

<header>
    <h1>Ù…Ø±ÙƒØ² Ø§Ù„Ø·Ø§Ù‡Ø±Ø© Ù„Ù„Ø£Ø´Ø¹Ø©</h1>
    <h2>Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª - Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h2>
    <p>Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ù‡Ø§Ù… ÙØ±ÙŠÙ‚ Ø§Ù„Ù€ IT Ù„Ø¬Ù…ÙŠØ¹ ÙØ±ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ² Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø¸Ù…</p>
    <div class="date-badge" id="today-date"></div>
</header>

<main>
    <!-- Ø´Ø±ÙŠØ· Ø¹Ù„ÙˆÙŠ -->
    <section class="toolbar">
        <div class="toolbar-right">
            <button class="btn btn-primary" id="reset-today">
                ğŸ” Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…
            </button>
            <button class="btn btn-outline" id="admin-toggle">
                âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Admin)
            </button>
        </div>
        <div class="toolbar-left">
            <span class="status-pill">
                <span class="status-dot" id="status-dot"></span>
                <span id="status-text">Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯</span>
            </span>
        </div>
    </section>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†: Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØªØ³Ø¬ÙŠÙ„Ù‡Ø§ ÙÙŠ Google Sheet -->
    <section id="admin-panel" class="admin-panel hidden">
        <h3>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h3>
        <p>
            Ù…Ù† Ù‡Ù†Ø§ ØªÙ‚Ø¯Ø± ØªØ¶ÙŠÙ Ù…Ù‡Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø©ØŒ ØªØ­Ø¯Ø¯ Ø§Ù„ÙØ±Ø¹ØŒ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ØŒ ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§ØªØŒ  
            ÙˆØªØªØ³Ø¬Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ <strong>Google Sheet</strong> ÙƒÙ‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ù…Ø±ÙƒØ².
        </p>

        <div class="admin-grid">
            <div class="admin-field">
                <label for="branch">Ø§Ù„ÙØ±Ø¹</label>
                <select id="branch">
                    <option value="Ø§Ù„Ù…Ù‚Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">Ø§Ù„Ù…Ù‚Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</option>
                    <option value="ÙØ±Ø¹ ÙÙŠØµÙ„">ÙØ±Ø¹ ÙÙŠØµÙ„</option>
                    <option value="ÙØ±Ø¹ Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø£Ù‡Ø±Ø§Ù…">ÙØ±Ø¹ Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø£Ù‡Ø±Ø§Ù…</option>
                    <option value="ÙØ±Ø¹ Ø§Ù„Ø¯Ù„ØªØ§">ÙØ±Ø¹ Ø§Ù„Ø¯Ù„ØªØ§</option>
                    <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                </select>
            </div>

            <div class="admin-field">
                <label for="role">Ø¯ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                <select id="role">
                    <option value="IT Manager">IT Manager</option>
                    <option value="System Admin">System Admin</option>
                    <option value="Network Engineer">Network Engineer</option>
                    <option value="Helpdesk">Helpdesk</option>
                </select>
            </div>

            <div class="admin-field">
                <label for="admin-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                <input type="text" id="admin-name" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø¹Ù…Ø±Ùˆ">
            </div>

            <div class="admin-field">
                <label for="task-title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <input type="text" id="task-title" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø±Ø§Ø¬Ø¹Ø© Ø±Ø¨Ø· Ø§Ù„ÙØ±ÙˆØ¹ Ø¨Ø§Ù„Ù€ VPN">
            </div>

            <div class="admin-field">
                <label for="task-category">ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <select id="task-category">
                    <option value="Ø´Ø¨ÙƒØ© ÙˆØ³ÙŠØ±ÙØ±Ø§Øª">Ø´Ø¨ÙƒØ© ÙˆØ³ÙŠØ±ÙØ±Ø§Øª</option>
                    <option value="Ø£Ù†Ø¸Ù…Ø© Ø·Ø¨ÙŠØ© (RIS/PACS/HIS)">Ø£Ù†Ø¸Ù…Ø© Ø·Ø¨ÙŠØ© (RIS/PACS/HIS)</option>
                    <option value="Backup & Storage">Backup & Storage</option>
                    <option value="Support & Helpdesk">Support & Helpdesk</option>
                    <option value="Security & Access">Security & Access</option>
                    <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                </select>
            </div>

            <div class="admin-field">
                <label for="task-frequency">ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                <select id="task-frequency">
                    <option value="ÙŠÙˆÙ…ÙŠÙ‹Ø§">ÙŠÙˆÙ…ÙŠÙ‹Ø§</option>
                    <option value="Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ‹Ø§">Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ‹Ø§</option>
                    <option value="Ø´Ù‡Ø±ÙŠÙ‹Ø§">Ø´Ù‡Ø±ÙŠÙ‹Ø§</option>
                    <option value="Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©">Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©</option>
                </select>
            </div>
        </div>

        <div class="admin-field">
            <label for="task-permissions">Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù…Ù‡Ù…Ø©</label>
            <input type="text" id="task-permissions" placeholder="Ù…Ø«Ø§Ù„: ØµÙ„Ø§Ø­ÙŠØ© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±ØŒ ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø§ÙˆØªØ±">
        </div>

        <div class="admin-field">
            <label for="task-notes-admin">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
            <textarea id="task-notes-admin" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ù‡Ù…Ø© ØªØªÙ… Ù‚Ø¨Ù„ Ø¨Ø¯Ø§ÙŠØ© Ø´ØºÙ„ Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙÙŠ ÙƒÙ„ Ø§Ù„ÙØ±ÙˆØ¹"></textarea>
        </div>

        <div class="admin-row">
            <span class="pill">
                ğŸ” ÙƒÙˆØ¯ Ø£Ù…Ø§Ù† Ø§Ù„Ø£Ø¯Ù…Ù†:
                <input type="password" id="admin-secret" placeholder="Admin Key" style="background: transparent; border: none; color: #f9fafb; font-size: 0.75rem; width: 90px;">
            </span>

            <button class="btn btn-primary" id="save-admin-task">
                ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ù…Ø© ÙÙŠ Google Sheet
            </button>
        </div>

        <div id="admin-message" class="admin-msg"></div>

        <div class="admin-badge">
            ğŸ” Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø§Ù„Ù„ÙˆØ­Ø© Ù„Ø§ ØªØ¹Ø¯Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø­ØªÙ‰ Ù†Ø±Ø¨Ø· Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ù…Ù† Google SheetØŒ
            Ù„ÙƒÙ†Ù‡Ø§ ØªØ­ÙØ¸ ÙƒÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ù‡Ù…Ø§Øª ÙÙŠ Ø§Ù„Ø´ÙŠØª ÙƒÙ…Ø±Ø¬Ø¹ Ø±Ø³Ù…ÙŠ Ù„Ù€ IT.
        </div>
    </section>

    <!-- Ø§Ù„ÙØ¦Ø§Øª ÙˆØ§Ù„Ù…Ù‡Ø§Ù… (ÙƒÙ…Ø§ Ù‡ÙŠ Ø¹Ù†Ø¯Ùƒ) -->
    <!-- ... Ù†ÙØ³ Ø£Ù‚Ø³Ø§Ù… Network / RIS / Backup / Support / Security Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± ... -->

    <!-- Ø§Ù„ÙØ¦Ø© 1: Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø´Ø¨ÙƒØ© ÙˆØ§Ù„Ø±Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹ -->
    <section class="category">
        <div class="category-header">
            <h2>Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø´Ø¨ÙƒØ© ÙˆØ§Ù„Ø±Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„ÙØ±ÙˆØ¹<span class="tag">Network</span></h2>
        </div>
        <span>Ø¶Ù…Ø§Ù† Ø¥Ù† ÙƒÙ„ ÙØ±ÙˆØ¹ Ù…Ø±ÙƒØ² Ø§Ù„Ø·Ø§Ù‡Ø±Ø© Ù…Ø±Ø¨ÙˆØ·Ø© ÙˆØ´ØºØ§Ù„Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„ Ø§ØªØµØ§Ù„</span>
        <div class="task-list" id="category-servers">
            <div class="task-item" data-task-id="ping-main-sites">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</div>
                <div class="task-meta">Ø§Ù„ØµØ¨Ø§Ø­ / Ø¨Ø¯Ø§ÙŠØ© ÙƒÙ„ Ø´ÙŠÙØª</div>
                <div class="task-notes">Ù…Ø«Ø§Ù„: Portal Ø§Ù„Ø­Ø¬Ø²ØŒ Ù†Ø¸Ø§Ù… MiClinic / RISØŒ Ø¨ÙˆØ§Ø¨Ø© Ø´Ø±ÙƒØ§Øª Ø§Ù„ØªØ£Ù…ÙŠÙ†</div>
            </div>

            <div class="task-item" data-task-id="check-branches-vpn">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø±Ø¨Ø· Ø§Ù„ÙØ±ÙˆØ¹ Ø¨Ø§Ù„Ù€ VPN ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</div>
                <div class="task-meta">Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹ + Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø¨Ù„Ø§Øº Ù…Ù† ÙØ±Ø¹</div>
                <div class="task-notes">ØªØ¬Ø±Ø¨Ø© Ping Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù…Ù† ÙØ±Ø¹ Ø£Ùˆ Ø¹Ø¨Ø± Monitoring</div>
            </div>

            <div class="task-item" data-task-id="check-switches">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙˆÙŠØªØ´Ø§Øª ÙˆØ§Ù„Ø±Ø§ÙˆØªØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ ÙƒÙ„ ÙØ±Ø¹</div>
                <div class="task-meta">Ø§Ù„ØµØ¨Ø§Ø­ + Ø¨Ø¹Ø¯ Ø£ÙŠ Ø§Ù†Ù‚Ø·Ø§Ø¹</div>
                <div class="task-notes">Ù„Ùˆ ÙÙŠ Monitoring System Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù€ Dashboard ÙˆØ§Ù„Ù€ Alerts</div>
            </div>
        </div>
    </section>

    <!-- Ø§Ù„ÙØ¦Ø© 2: Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ø´Ø¹Ø© ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø·Ø¨ÙŠØ© -->
    <section class="category">
        <div class="category-header">
            <h2>Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø£Ø´Ø¹Ø© ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø·Ø¨ÙŠØ©<span class="tag">RIS / PACS / HIS</span></h2>
        </div>
        <span>Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø£ÙÙ„Ø§Ù… Ø´ØºØ§Ù„ ÙÙŠ ÙƒÙ„ Ø§Ù„ÙØ±ÙˆØ¹ Ø¨Ø¯ÙˆÙ† ØªÙˆÙ‚Ù</span>
        <div class="task-list" id="category-systems">
            <div class="task-item" data-task-id="ris-login-test">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¬Ø² / RIS / MiClinic Ù…Ù† ÙØ±Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ</div>
                <div class="task-meta">Ù‚Ø¨Ù„ Ø¨Ø¯Ø§ÙŠØ© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…Ø±Ø¶Ù‰</div>
                <div class="task-notes">ØªØ¬Ø±Ø¨Ø© LoginØŒ ÙØªØ­ Ø´Ø§Ø´Ø© Ø­Ø¬Ø²ØŒ Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ±</div>
            </div>

            <div class="task-item" data-task-id="pacs-connection">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø£Ø´Ø¹Ø© Ø¨Ø³ÙŠØ±ÙØ± Ø§Ù„Ù€ PACS</div>
                <div class="task-meta">Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                <div class="task-notes">Ù…ØªØ§Ø¨Ø¹Ø© Queue Ø§Ù„Ø¯Ø±Ø§Ø³Ø§ØªØŒ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¯Ø±Ø§Ø³Ø§Øª Ø¹Ø§Ù„Ù‚Ø©</div>
            </div>

            <div class="task-item" data-task-id="printing-reports">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„ Ø§Ù„Ø·Ø§Ø¨Ø¹Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø´Ø¹Ø© ÙÙŠ Ø§Ù„ÙØ±ÙˆØ¹</div>
                <div class="task-meta">ØµØ¨Ø§Ø­Ù‹Ø§</div>
                <div class="task-notes">Ø·Ø¨Ø§Ø¹Ø© ØªÙ‚Ø±ÙŠØ± ØªØ¬Ø±ÙŠØ¨ÙŠ / Test Print Ù„Ùˆ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±</div>
            </div>
        </div>
    </section>

    <!-- Ø§Ù„ÙØ¦Ø© 3: Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ -->
    <section class="category">
        <div class="category-header">
            <h2>Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰<span class="tag">Backup</span></h2>
        </div>
        <span>Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø¶Ù‰ ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØµÙˆØ± Ù…Ù† Ø§Ù„Ø¶ÙŠØ§Ø¹ Ø£Ùˆ Ø§Ù„ØªÙ„Ù</span>
        <div class="task-list" id="category-backup">
            <div class="task-item" data-task-id="check-backup-status">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„Ù„ÙŠÙ„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</div>
                <div class="task-meta">ØµØ¨Ø§Ø­ ÙƒÙ„ ÙŠÙˆÙ…</div>
                <div class="task-notes">Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù€ Backup Jobs ØªÙ…Øª Ø¨Ø¯ÙˆÙ† Errors Ø¹Ù„Ù‰ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…Ù„ÙØ§Øª Ø§Ù„Ù€ PACS</div>
            </div>

            <div class="task-item" data-task-id="check-storage-space">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø¹Ù„Ù‰ Ø³ÙŠØ±ÙØ±Ø§Øª Ø§Ù„Ø¨Ø§Ùƒ Ø£Ø¨ ÙˆØ§Ù„Ù€ NAS</div>
                <div class="task-meta">Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                <div class="task-notes">Ù„Ø§ ØªÙ‚Ù„ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø¹Ù† Ù†Ø³Ø¨Ø© Ø¢Ù…Ù†Ø© (Ù…Ø«Ù„Ø§Ù‹ 20%)</div>
            </div>
        </div>
    </section>

    <!-- Ø§Ù„ÙØ¦Ø© 4: Ø¯Ø¹Ù… Ø§Ù„ÙØ±ÙˆØ¹ ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙŠÙ† -->
    <section class="category">
        <div class="category-header">
            <h2>Ø¯Ø¹Ù… Ø§Ù„ÙØ±ÙˆØ¹ ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙŠÙ†<span class="tag">Support</span></h2>
        </div>
        <span>Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙˆØ§Ù„Ø£Ø·Ø¨Ø§Ø¡ ÙˆØ§Ù„ÙÙ†ÙŠÙŠÙ† ÙÙŠ ÙƒÙ„ ÙØ±ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ²</span>
        <div class="task-list" id="category-support">
            <div class="task-item" data-task-id="check-ticket-system">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯Ø¹Ù… / Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù…ÙØªÙˆØ­Ø© (Tickets)</div>
                <div class="task-meta">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙŠÙˆÙ… / Ù…Ù†ØªØµÙ Ø§Ù„ÙŠÙˆÙ… / Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´ÙŠÙØª</div>
                <div class="task-notes">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø¨Ù…Ø³ØªÙˆÙŠØ§Øª: Critical / High / Normal</div>
            </div>

            <div class="task-item" data-task-id="follow-up-critical-users">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø­Ø±Ø¬Ø© Ù„Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø­Ø³Ø§Ø³Ø© (Ø­Ø³Ø§Ø¨Ø§ØªØŒ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ØŒ Ø¥Ø¯Ø§Ø±Ø©)</div>
                <div class="task-meta">Ø®Ù„Ø§Ù„ Ø§Ù„ÙŠÙˆÙ…</div>
                <div class="task-notes">Ø§ØªØµØ§Ù„ / Ø±Ø³Ø§Ù„Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø­Ø§Ù„Ø© ÙƒÙ„ Ù…Ø´ÙƒÙ„Ø©</div>
            </div>
        </div>
    </section>

    <!-- Ø§Ù„ÙØ¦Ø© 5: Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª -->
    <section class="category">
        <div class="category-header">
            <h2>Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª<span class="tag">Security & Access</span></h2>
        </div>
        <span>Ø¶Ø¨Ø· ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©ØŒ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©</span>
        <div class="task-list" id="category-security">
            <div class="task-item" data-task-id="antivirus-dashboard">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…Ø¶Ø§Ø¯ Ø§Ù„ÙÙŠØ±ÙˆØ³Ø§Øª / EDR Ù„ÙƒÙ„ Ø§Ù„ÙØ±ÙˆØ¹</div>
                <div class="task-meta">Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                <div class="task-notes">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ØµØ§Ø¨Ø© Ø£Ùˆ Out-of-date ÙˆØ§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§</div>
            </div>

            <div class="task-item" data-task-id="failed-logins">
                <div class="task-checkbox">
                    <input type="checkbox">
                </div>
                <div class="task-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ§Ø´Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±Ø§Øª ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø©</div>
                <div class="task-meta">Ù…Ø±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
                <div class="task-notes">Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£ÙŠ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªÙƒØ±Ø±Ø© Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨Ø§Øª Ø­Ø³Ø§Ø³Ø©</div>
            </div>
        </div>
    </section>

    <p class="footer">
        Ù‡Ø°Ù‡ Ø§Ù„Ù„ÙˆØ­Ø© Ù…Ø®ØµØµØ© Ù„ØªÙ†Ø¸ÙŠÙ… <strong>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù„Ù‚Ø³Ù… ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù…Ø±ÙƒØ² Ø§Ù„Ø·Ø§Ù‡Ø±Ø© Ù„Ù„Ø£Ø´Ø¹Ø©</strong>.  
        ÙŠØªÙ… Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ù‡Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø­Ù„ÙŠ (LocalStorage)ØŒ ÙˆÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… <strong>Google Sheet</strong> ÙƒÙ‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª
        Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ù† Ø®Ù„Ø§Ù„ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†.
    </p>
</main>

<!-- Iframe Ù…Ø®ÙÙŠ Ø¹Ù„Ø´Ø§Ù† Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø±Ø¯ Ø§Ù„ÙÙˆØ±Ù… Ø¨Ø¯ÙˆÙ† Ù…Ø§ ÙŠÙØªØ­ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø© -->
<iframe name="hidden_iframe" style="display:none;"></iframe>

<script>
    // ===== Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø± =====
    function formatArabicDate(date) {
        const options = {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        };
        return date.toLocaleDateString('ar-EG', options);
    }

    const today = new Date();
    const todayKey = today.toISOString().slice(0, 10); // YYYY-MM-DD
    const storagePrefix = "tahra_it_daily_tasks_";
    const storageKey = storagePrefix + todayKey;

    document.getElementById("today-date").textContent = "ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…: " + formatArabicDate(today);

    // ===== ØªØ­Ù…ÙŠÙ„ ÙˆØ­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ø§Ù… (LocalStorage) =====
    function loadTasksState() {
        const saved = localStorage.getItem(storageKey);
        if (!saved) return {};
        try {
            return JSON.parse(saved);
        } catch (e) {
            console.error("Error parsing tasks state", e);
            return {};
        }
    }

    function saveTasksState(state) {
        localStorage.setItem(storageKey, JSON.stringify(state));
    }

    const tasksState = loadTasksState();
    const taskItems = document.querySelectorAll(".task-item");

    taskItems.forEach(item => {
        const checkbox = item.querySelector("input[type='checkbox']");
        const taskId = item.getAttribute("data-task-id");

        if (!checkbox || !taskId) return;

        if (tasksState[taskId]) {
            checkbox.checked = true;
            item.classList.add("task-done");
        }

        checkbox.addEventListener("change", () => {
            tasksState[taskId] = checkbox.checked;
            if (!checkbox.checked) {
                delete tasksState[taskId];
            }
            saveTasksState(tasksState);
            updateSummary();
        });
    });

    // ===== Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø± =====
    function updateSummary() {
        const total = taskItems.length;
        let done = 0;

        taskItems.forEach(item => {
            const checkbox = item.querySelector("input[type='checkbox']");
            if (checkbox && checkbox.checked) {
                done++;
                item.classList.add("task-done");
            } else {
                item.classList.remove("task-done");
            }
        });

        const statusText = document.getElementById("status-text");
        const statusDot = document.getElementById("status-dot");

        if (done === 0) {
            statusText.textContent = "Ù„Ù… ØªØ¨Ø¯Ø£ Ø¨Ø¹Ø¯ (" + done + " / " + total + ")";
            statusDot.style.background = "#9ca3af";
        } else if (done < total) {
            statusText.textContent = "Ø¬Ø§Ø±Ù Ø§Ù„ØªÙ†ÙÙŠØ° (" + done + " / " + total + ")";
            statusDot.style.background = "#f59e0b";
        } else {
            statusText.textContent = "ØªÙ… Ø¥Ù†Ø¬Ø§Ø² ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… âœ… (" + done + " / " + total + ")";
            statusDot.style.background = "#22c55e";
        }
    }

    updateSummary();

    // ===== Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ù„Ù„ÙŠÙˆÙ… =====
    document.getElementById("reset-today").addEventListener("click", () => {
        if (!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ØŸ")) return;

        taskItems.forEach(item => {
            const checkbox = item.querySelector("input[type='checkbox']");
            if (checkbox) checkbox.checked = false;
            item.classList.remove("task-done");
        });

        localStorage.removeItem(storageKey);
        for (const key in tasksState) {
            if (Object.prototype.hasOwnProperty.call(tasksState, key)) {
                delete tasksState[key];
            }
        }
        updateSummary();
    });

    // ===== Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† (Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡) =====
    const adminToggleBtn = document.getElementById("admin-toggle");
    const adminPanel = document.getElementById("admin-panel");
    const adminMsg = document.getElementById("admin-message");

    adminToggleBtn.addEventListener("click", () => {
        const isHidden = adminPanel.classList.contains("hidden");
        if (isHidden) {
            adminPanel.classList.remove("hidden");
            adminToggleBtn.classList.add("admin-toggle-active");
        } else {
            adminPanel.classList.add("hidden");
            adminToggleBtn.classList.remove("admin-toggle-active");
        }
    });

    // ===== Ø±Ø¨Ø· Google Sheet: Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ€ Form Ù„ØªÙØ§Ø¯ÙŠ CORS =====
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzlPJ1ILVO-P5TlWuU5hCC2a4h7HkOMCpflKtfCmvHRLvESBAKcJ33UiJve3hrvbkw/exec";

    function sendTaskToGoogleSheet(payload) {
        console.log("Sending payload via FORM to Apps Script:", payload);

        // Ø¥Ù†Ø´Ø§Ø¡ Form Ù…Ø®ÙÙŠ
        const form = document.createElement("form");
        form.method = "POST";
        form.action = GOOGLE_SCRIPT_URL;
        form.target = "hidden_iframe"; // Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠÙØªØ­Ø´ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©
        form.style.display = "none";

        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ù‚ÙˆÙ„
        for (const [key, value] of Object.entries(payload)) {
            const input = document.createElement("input");
            input.type = "hidden";
            input.name = key;
            input.value = value;
            form.appendChild(input);
        }

        document.body.appendChild(form);
        form.submit();
        document.body.removeChild(form);

        // Ù‡Ù†Ø¹ØªØ¨Ø± Ø¥Ù† Ù…ÙÙŠØ´ Error Ø·Ø§Ù„Ù…Ø§ Ù…Ø§ÙÙŠØ´ Ø§Ø³ØªØ«Ù†Ø§Ø¡
        return { status: "success" };
    }

    document.getElementById("save-admin-task").addEventListener("click", async () => {
        adminMsg.textContent = "";
        adminMsg.className = "admin-msg";

        const payload = {
            branch: document.getElementById("branch").value.trim(),
            role: document.getElementById("role").value.trim(),
            adminName: document.getElementById("admin-name").value.trim(),
            taskTitle: document.getElementById("task-title").value.trim(),
            taskCategory: document.getElementById("task-category").value.trim(),
            taskFrequency: document.getElementById("task-frequency").value.trim(),
            taskPermissions: document.getElementById("task-permissions").value.trim(),
            taskNotes: document.getElementById("task-notes-admin").value.trim(),
            adminSecret: document.getElementById("admin-secret").value.trim(),
            date: todayKey
        };

        if (!payload.taskTitle || !payload.adminName || !payload.adminSecret) {
            adminMsg.textContent = "Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©ØŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ØŒ ÙˆÙƒÙˆØ¯ Ø§Ù„Ø£Ù…Ø§Ù†.";
            adminMsg.classList.add("error");
            return;
        }

        try {
            adminMsg.textContent = "Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸ ÙÙŠ Google Sheet ...";

            const result = await sendTaskToGoogleSheet(payload);

            if (result && result.status === "success") {
                adminMsg.textContent = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¥Ù„Ù‰ Google Sheet (ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´ÙŠØª Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„).";
                adminMsg.classList.add("success");

                document.getElementById("task-title").value = "";
                document.getElementById("task-permissions").value = "";
                document.getElementById("task-notes-admin").value = "";
            } else {
                adminMsg.textContent = "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ù„ÙƒÙ† Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø¯. Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø´ÙŠØª Ù„Ù„ØªØ£ÙƒØ¯.";
                adminMsg.classList.add("error");
            }
        } catch (err) {
            console.error("Error while calling Apps Script:", err);
            adminMsg.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª. Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù€ URL Ø£Ùˆ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª.";
            adminMsg.classList.add("error");
        }
    });
</script>

</body>
</html>
